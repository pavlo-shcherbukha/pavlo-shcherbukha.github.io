---
layout: post
title: "E-LAB. Phase-shift oscillator using BJT"
date: 2025-01-16 10:00:01
categories: [e-lab]
permalink: posts/2025-01-16/elab-bjt-phase-shift-oscillator/
published: true
---

<!-- TOC BEGIN -->

<!-- TOC END -->

## <a name="p1">1. Вступ</a>
На написання цього посту мене надихнув професійний радіо інженер, а зараз просто радіолюбитель [Радиодинозавр: 3.2.Базовый генератор внутрисхемной диагностики. ](https://www.youtube.com/watch?v=hohz248USWc).
В лабораторії електроніки генератор синуса на кількох частотах - річ необхідна і корисна. І на його канал  я наскочив в пошуках, як найпростіше зробити генератор синусоїдальних коливань. 
Мені сподобалася його ідея, і я захотів її використати. Але є нюанс: у мене немає радянських радіодеталей. Ні, ну можна піти на раіоринок, щось найти. 
Але то не наш метод. Для себе я поставив за ціль використовувати тільки сучасну компонентну базу. Колись, в дитинстві, я уже мав проблеми, 
коли випаював компоненти ще з лампових радіоприймачів, але компоненти були не працездатними і я витрачав дуже багато часу на пошук несправностей в зібраних мною схемах. 
Тому мені потрібно було адаптувати його принципову схему під сучасні компоненти. Він теж зробив колись велику роботу по адаптації схеми для германієвих транзисторів до кремнієвого КТ-315.



<HTML>
<HEAD>
<TITLE>Принципова схема генраторів на 1 кГц та 10 кГц  від [Радиодинозавр](https://www.youtube.com/@%D0%A0%D0%B0%D0%B4%D0%B8%D0%BE%D0%B4%D0%B8%D0%BD%D0%BE%D0%B7%D0%B0%D0%B2%D1%80)</TITLE>
</HEAD>
<BODY>
<TABLE BORDER="1">
<TR>
    <TH>Генератор на 1 кГц </TH>
    <TH>Генератор на 10 кГц </TH>
</TR>
<TR>
    <TD><kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-01.png" /></kbd>
<p style="text-align: center;"><a name="pic-01">pic-01</a></p></TD>
    <TD><kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-02.png" /></kbd>
<p style="text-align: center;"><a name="pic-02">pic-02</a></p></TD>
</TR>
</TABLE>
</BODY>
</HTML>


 От мені захотілося їх повторити, тільки на сучасних електронних компонентах, та ще і тих, що у мене є в наявності.


## <a name="p2">2. Хід моїх розжумів та пошуків</a>

Перше, що я зробив, це поклав руки на клавіатуру  комп'ютера і пошукав такі схеми. Як виявилося їх повно і в російськомвному сегменті і в англомовному. 
Друге, що зробив, глянув свій конспект по електроніці і знайшов там щось дуже схоже:

<kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-03.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-03">pic-03</a></p>

А далі, раз ячейки Сіффера (правда я їх не знайшов) - значить потрібно шукати в англомовному сегменті інтернета. Але пошук, окрім загальних схем нічого не показав, тому взяв, 
розрахував сам, як розумів, з використанням тих компонентів, що в мене є. 
В процесі пошуків, я прийшов до висновку, що в англомовному сегмент інтернета ця схема генератора досить відома і викорситовується як для біполярних так і для польових 
транзисторів, а ще використовується і для генераторів на операційних підсилювачах. Якщо узагальнити, то зворотній зв'язок з переворотом фази досить очевидна ідея для інжнера, 
що знайомий з курсом ТОЕ. 

Потім, зважаючи на проблеми, на які натикався [Радиодинозавр](https://www.youtube.com/@%D0%A0%D0%B0%D0%B4%D0%B8%D0%BE%D0%B4%D0%B8%D0%BD%D0%BE%D0%B7%D0%B0%D0%B2%D1%80)  вирішив 
спершу змоделювати роботу схеми за допомогою програми Kicad-8  з використанням SPICE-model. 
Як виявилося SPICE моделі на сайтах розробників компонентів дуже часто лежать поряд з DataSheets на компонент. Тому для транзистора я її і використав. Лише додам, що 
після випуску з університету, я працював з PCAD  та ORCAD,  але в основному для автоматичної розводки друкованих плат. А тут, зайнявся моделюванням роботи аналогових схем. 
Ще я спробував  Online програму [CircuitLab](https://www.circuitlab.com/). Але, там, здається, що транзистор використовує якусь дуже середню модель. Та і при безплатному тарифі
 там багато не намалюєш. Тому я витратив трохи часу ще і на те, як на мою Raspberry встановити більш-менш сучасну версію KiCad-8.
А моделювання в KiCad  мені здалося більше якісним, ніж у CircuitLab, но це не точно.  Ну, я намалював в KiCad  принципову схему. Потім змоделював, підправив під конкретні компоненти,
що в мене є в наявності, знову змоделював.  
Потім зібрав на макеті з реальних компонентів. І воно якось запрацювало, тільки не так, яу мені треба. 
То ж тепер хочу познайомити з отриманими результатми і описати проблеми, на які я натикався і як вирішував.



### <a name="p3">3. Принципові схеми генераторів на 1 кГц та на 10кГц</a>



<TITLE>Принципова схема генраторів на 1 кГц та 10 кГц  на іноземних компонентах</TITLE>
</HEAD>
<BODY>
<TABLE BORDER="1">
<TR>
    <TH>Генератор на 1 кГц </TH>
    <TH>Генератор на 10 кГц </TH>
</TR>
<TR>
    <TD><kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-04.png" /></kbd>
<p style="text-align: center;"><a name="pic-04">pic-04</a></p></TD>
    <TD><kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-05.png" /></kbd>
<p style="text-align: center;"><a name="pic-05">pic-05</a></p></TD>
</TR>
</TABLE>
</BODY>
</HTML>


Фактично, схеми відрізняються тільки ємністю конденсаторів C1, C2, C3 та конденсатором C4. Потрібно звернути увагу на ємність обхідного  конденсатора  C4. 
Для частоти в 1 kHz він повинен мати ємність 47uF і більше. Для частоти 10kHz він повинен мати ємність  10uF і більше.

За допомогою змінного резистора RV1  вибираємо режим роботи транзистора так, щоб генерація була  стійкою, а синусоїда була синусоїдою з мінімальними викривленнями. 
Транзистор 2N2222  або PN2222  одне і те саме. PN2222 вказує, зо корпус транзистора пластмасовий типу TO-92, а 2N2222 випускаються в металевому корпусі. 
ДатаШит на цей транзистор пожна подивитися за лінком: [2N2222](../assets/img/posts/2025-01-16-e-lab-gensin/doc/2n2222_2n2222a.pdf). 
За показниками тестера транзисторів в мультиметрі, коефіцієнт передачі транзисторів по току 242 і 276. 

### <a name="p4">4. Проблеми запуску на налагодження генераторів</a>

Спершу я розірвав зворотній зв'язок що йде від колектора до конденсатора фазо-зміщуючого ланціюжка С1 і  виставив режим  роботи транзистора на постійному струму десь 
в районі 5.1V-6.2V. Потім відновив з'єднання і генерація зразу пішла. Ну може трошки спотворена форма синусу, але за допомогою змінного резистора RV1, я її відкорегував. 
Основною проблемою  при запуску було те, що я не оцінив важливісь конlенсатора С4 і поставив "що було під рукою", а саме неполярний 100nF. В результаті генератор видава 
прекрасний синус на частоті 25-26 kHz, але зміна коненсаторів фазо-зміщуйочого ланціюжка призводила до зриву генерації, а зміна резисторів в ланцюжку могла монизити 
частоту десь до 25kHz. А от як тільки замінив С4 на 100 uF,  так зразу генератори і запрацювали на потрібній частоті. Пізніше, вже дослідним шляхом підібрав найнижчі 
номінали C4,  при яких частота генерації стабільна, звичайно, з того що в мене було. Фактично, отримав частоти генерації: 1,2 kHz  та 13 kHz. Тобто відхилення від номінала 
до 30%, але поки мені це не приципово. Без конденсатора C4  генерація взагалі не запускається. При замалому номіналі C4  частота генерації збільшується. При ємності в 1uF  на 
генераторі 10kHz  частота піднімалася до 16kHz. Чому так відбувається, я пояснення не знайшов. Цей конденсатор повинен обмежувати  низькі частоти. Але чому він так впливає на 
частоту генерації - поки не знаю. 

А ще, у мене нижній сегмент синусоїди був трошки спотворений, незважаючи на всі мої спроби акуратно покрутити резистор RV1.  Цю проблему я виправив, шляхом 
збільшення негативного зворотнього зв'язку по постійному струму, а саме збільшив номінал R6 зі 100 до 150kOm

Зовнішній вигляд змантованих генераторів на макетній платі показано на: [pic-06](#pic-06).

<kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-06.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-06">pic-06</a></p>



Ліворуч змонтовано генератор на 1kHz, а праворуч на 10kHz. Генератори мають роздільне живлення. Так, зараз червоний провід від крони підключений до верхньої шини і 
живить генератор на 1kHz. Для того, щоб заживити генератор на 10kHz червоний провід від крони треба перенсти на нижню черону шину макетної плати.  Правороч темні 
проводки  з'єднали загальну шину. Туди підходить чорний провід від крони. В Збільшеному варіанті монтаж генераторів показано на   [pic-07](#pic-07)

### <a name="p5">5. Тестування генератора 1 kHz</a>

<kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-07.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-07">pic-07</a></p>

Тепер трошки займемося вимірами генератора на 1 kHz. Далі наведені покази осцилографа для шенератора на 1 кГц

<TITLE>Покази осцилографа на 1 кГц</TITLE>
</HEAD>
<BODY>
<TABLE BORDER="1">
<TR>
    <TH><a name="pic-08">pic-08</a> </TH>
    <TH><a name="pic-09">pic-09</a> </TH>
</TR>
<TR>
    <TD><kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-08.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-08">pic-08</a></p></TD>
    <TD><kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-09.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-09">pic-09</a></p></TD>
</TR>
</TABLE>
</BODY>
</HTML>

Як бачимо, синусоїда досить прийнятна, частотою 1.25kHz. Тепер глянемо робочу точку транзистора. При живлені 8.84V [pic-10](#pic-10)
<kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-10.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-10">pic-10</a></p>
я відключив звортній зв'язок і заміряв напругу на  колекторі транзистора. Як бачиом, 5.1V. 

<kbd><img src="../assets/img/posts/2025-01-16-e-lab-gensin/doc/pic-11.jpg" /></kbd>
<p style="text-align: center;"><a name="pic-11">pic-11</a></p>


### <a name="p6">6. Тестування генератора 10 kHz</a>



