---
layout: post
title: "AZURE AZ-204 AZ BLOB STORAGE"
date: 2025-10-16 10:00:01
categories: [azure]
permalink: posts/2025-10-16/az-204-blob-strg/
published: true
---

<!-- TOC BEGIN -->

- [1. Про що цей блог](#p-1")
- [2. Обгрунтування, чому це правильно](#p-2)
- [3. Ключові моменти, які будуть нівелювати розробку такого аналізу](#p-3)
- [3.1. Заперечення: "Документи клієнтів у хмарі зберігати не можна (Безпека/Нормативні вимоги)"](#p-3.1)
- [3.2. Заперечення: "Тарифи хмари непідйомні"](#p-3.2)
- [3.3. Заперечення: "Ми вже купили сервери і платимо за їх обслуговування"](#p-3.3)


<!-- TOC END -->

## <a name="p-1">1. Про що цей блог</a>

Вивчаючи інструенти в хмарі azure, що можуть використовувати розробники для розробки прикладних додатків шукав якусь цікаву реалістичну задачу для навчання, яка б використовувала Azure Blob Storage. Я вже, використовую  api для роботи з BlobStorage, використовую утиліту azcopy.  Але все це були виключно теоретичні та практичні цеглинки, з яких можна побудувати додаток, як за вказаним лінками:
-  [az-204-funcs](https://github.com/pavlo-shcherbukha/az-204-funcs);
-  [Розробка прототипу використання утілти копіювання файлів azcopy в парі з azure BlobStorage використовуючи авторизацію Service Principal](https://github.com/pavlo-shcherbukha/azlearning/blob/tz-000001/azcopy_p.md).  

Потім, почав шукати бізнесову задачу, яка б якось мотивувати клієнта використати хмару azure, а мені б слугувала підставою для розробки навчального проекту. Задача якось виникла сама собою в процесі спілкування зі своїми клегами. Задача ця не стосується якогось окремого клієнта.  Це досить середньозважене формулювання проблеми, що, як мені здається, досить часто можна занйти в організаціях, що мають "довгу" історію програмного забезепечення, для прикладу, використовують  одні і ті ж бази даних ще з епохи клієнт-серверних архітектур, переробляючи тільки самі програми-клієнти.

В таких організаціях часто використовується підхід, коли великі бінарні файли зберігаються в BLOB  полях бази даних. За звичай, це стосується великих корпоративних баз даних типу ORACLE, MSSQL, може DB2. Але в останній час, тенденція стала такою, що кількість і об'єм файлів, що треба зберігати росте в геомертичній прогресії. І з цим щось треба робити. 

Що це можуть бути за  файли? Це можуть бути:

- особисті документи клієнтів-фізичних осіб, такі як паспорти, свідоцтва про народження чи одруження, договори, страховки;
- установчі документи юридичних осіб, такі як реєстраційні докумети, устави прідприємства, податкова інформація, договори, страховки;
- медичні документи (лікарські висновки, діагностичні фото МРТ, УЗІ, рентгенів);
- фотографії продуктів;
- різні постанови, виконавчі документи, платіжні документи, -
і таке  перелічувати можна довго.

**Ідея полягає в тому, щоб винести BLOB-дані (файлі-документів) з реляційної бази даних Oracle (MSSQL, DB2)  на об'єктне сховище (наприклад, Azure Blob Storage)**.

    Далі по тексту, я  буду використовувати реляційну БД ORACLE,  так як, на мій погляд, це найяастіший приклад. Та і досвід її використання у мене найбільший.

    Я не буду детально порівнбвати разні варіанти об'єктових сховищ типу: [AWS S3](https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html), [IBM Cloud Object Storage](https://www.ibm.com/products/cloud-object-storage), [Azure Blob Storage](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction). Моя ціль - вивчення azure cloud.


## <a name="p-2">2. Обгрунтування, чому це правильно</a>

**Продуктивність РБД:**

- Збільшення розміру таблиць/індексів: Великі BLOBи ускладнюють кешування даних у пам'яті (buffer cache) РБД.

- Уповільнення резервного копіювання/відновлення (Backup/Recovery): Копіювання величезної бази даних, більша частина якої — статичні документи, займає надзвичайно багато часу та ресурсів.

- Роздуття бази даних: Зростання розміру БД вимагає дорожчих ліцензій Oracle (які часто залежать від обсягу або використання ресурсів) та потужнішого обладнання.

**Вартість зберігання:**

- Вартість зберігання 1 ТБ даних у РБД Oracle (особливо з урахуванням ліцензій та необхідної продуктивності) на порядки вища, ніж вартість зберігання того ж обсягу в Azure Blob Storage (особливо на холодному/архівному рівні, якщо документи рідко використовуються).

**Масштабованість:**

- Об'єктне сховище, як Azure Blob Storage, надає практично необмежену та горизонтальну масштабованість, на відміну від вертикально масштабованої (і дорогої) РБД.


## <a name="p-3">3. Ключові моменти, які будуть нівелювати розробку такого аналізу</a>

### <a name="p-3.1">3.1. Заперечення: "Документи клієнтів у хмарі зберігати не можна (Безпека/Нормативні вимоги)"</a>

1. Шифрування: Дані завжди шифруються як під час передачі (TLS/SSL), так і у стані спокою (Azure Storage Service Encryption). 
2. Контроль доступу: Використання Shared Access Signatures (SAS) та Azure Active Directory для доступу дає гранульований контроль, на відміну від часто неоптимальних налаштувань у РБД. 
3. Комплаєнс (Норми): Azure має тисячі сертифікатів відповідності (ISO, SOC, GDPR тощо), які підтверджують, що вона відповідає або перевищує вимоги більшості регуляторів, на відміну від локального ДЦ. 
4. Фізична безпека: Дата-центри Azure захищені набагато краще, ніж локальні серверні приміщення.
5. Ми зберігатимемо в БД лише метадані (ім'я файлу, хеш, посилання на Blob) та видалимо самі конфіденційні BLOBs, зменшуючи ризики компрометації РБД.

**Висновок:**
  Навпаки, ми підвищуємо безпеку. Хмара забезпечує рівень захисту, який важко досягти в локальному ДЦ.


### <a name="p-3.2">3.2. Заперечення: "Тарифи хмари непідйомні"</a>

Тут потрібно зауважити з власного досвіду, що я таке зауваження чув не раз, а от внятного економічного розрахунку ніколи не бачив. Його навіть не хотіли проводити.

1. Зберігання статичних  об'ємних  даних в ліцензованій РБД - це зберігання  в найдорожчому місці. Перенесення BLOBs зменшує розмір БД, що може знизити майбутні ліцензійні/апаратні вимоги до Oracle. 
2. Економія на операціях (OpEx): Вартість Azure Blob Storage ($/ГБ) у десятки разів нижча за вартість зберігання в Oracle. 
3. Рівні зберігання: Документи, які старші за 6 місяців, можна перемістити з рівня Hot на Cool або Archive (за $0.001 на місяць за ГБ!), автоматизувавши економію. А в базі даних вони будуть "лежати" за однаковою ціною
4. Надійність: Висока географічна/зонна реплікація (3-12 копій) входить у вартість, замінюючи необхідність купувати дороге обладнання для локального бекапу.

**Висновок:**
  Ми не просто купуємо зберігання, ми купуємо економію на найдорожчих компонентах системи.

### <a name="p-3.3">3.3. Заперечення: "Ми вже купили сервери і платимо за їх обслуговування"</a>

1. Зменшуючи навантаження на Oracle Server (менше операцій введення/виведення, менші таблиці) -  подовжує термін служби наявного обладнання та відтерміновує необхідність дорогого апгрейду. 
2. Сервери повинні займатися обробкою транзакцій (чим Oracle займається найкраще), а не обслуговуванням статичного файлового сховища. 
3. За звичай Клієнт вже платить за Azure (Office 365 часто надає доступ до деяких ресурсів або клієнт вже маєте підписку). Використання наявного інструменту є логічним кроком. 
4. Замість витрачати час на адміністрування/доопрацювання/оптимізацію зростаючого файлового сховища в БД, співробітники можуть сфокусуватися на більш критичних бізнес-задачах чи освоїти щось нове.

